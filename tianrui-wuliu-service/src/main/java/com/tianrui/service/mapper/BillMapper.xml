<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianrui.service.mapper.BillMapper">
	<resultMap id="BaseResultMap" type="com.tianrui.service.bean.Bill">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="ID" property="id" jdbcType="VARCHAR" />
		<result column="planid" property="planid" jdbcType="VARCHAR" />
		<result column="vehicleid" property="vehicleid" jdbcType="VARCHAR" />
		<result column="driverid" property="driverid" jdbcType="VARCHAR" />
		<result column="routeid" property="routeid" jdbcType="VARCHAR" />
		<result column="drivername" property="drivername" jdbcType="VARCHAR" />
		<result column="drivertel" property="drivertel" jdbcType="VARCHAR" />
		<result column="vehicleno" property="vehicleno" jdbcType="VARCHAR" />
		<result column="vehicletypeName" property="vehicletypename"
			jdbcType="VARCHAR" />
		<result column="cargoname" property="cargoname" jdbcType="VARCHAR" />
		<result column="startcity" property="startcity" jdbcType="VARCHAR" />
		<result column="consignorname" property="consignorname"
			jdbcType="VARCHAR" />
		<result column="consignortel" property="consignortel" jdbcType="VARCHAR" />
		<result column="endTime" property="endtime" jdbcType="VARCHAR" />
		<result column="startTime" property="starttime" jdbcType="VARCHAR" />
		<result column="endcity" property="endcity" jdbcType="VARCHAR" />
		<result column="receivername" property="receivername" jdbcType="VARCHAR" />
		<result column="receivertel" property="receivertel" jdbcType="VARCHAR" />
		<result column="priceUnits" property="priceunits" jdbcType="VARCHAR" />
		<result column="distance" property="distance" jdbcType="DOUBLE" />
		<result column="price" property="price" jdbcType="DOUBLE" />
		<result column="type" property="type" jdbcType="TINYINT" />
		<result column="status" property="status" jdbcType="TINYINT" />
		<result column="waybillno" property="waybillno" jdbcType="VARCHAR" />
		<result column="weight" property="weight" jdbcType="DOUBLE" />
		<result column="trueweight" property="trueweight" jdbcType="DOUBLE" />
		<result column="ownerid" property="ownerid" jdbcType="VARCHAR" />
		<result column="venderid" property="venderid" jdbcType="VARCHAR" />
		<result column="venderdelflag" property="venderdelflag"
			jdbcType="TINYINT" />
		<result column="ownerdelflag" property="ownerdelflag" jdbcType="TINYINT" />
		<result column="driverdelflag" property="driverdelflag"
			jdbcType="TINYINT" />
		<result column="orgid" property="orgid" jdbcType="VARCHAR" />
		<result column="plancode" property="plancode" jdbcType="VARCHAR" />
		<result column="creator" property="creator" jdbcType="VARCHAR" />
		<result column="createtime" property="createtime" jdbcType="BIGINT" />
		<result column="modifier" property="modifier" jdbcType="VARCHAR" />
		<result column="modifytime" property="modifytime" jdbcType="BIGINT" />
		<result column="pickupimgurl" property="pickupimgurl" jdbcType="BIGINT" />
		<result column="signimgurl" property="signimgurl" jdbcType="BIGINT" />
		<result column="overnumber" property="overnumber" jdbcType="VARCHAR" />
		<result column="totalnumber" property="totalnumber" jdbcType="VARCHAR" />
		<result column="tallage" property="tallage" jdbcType="DOUBLE" />
		<result column="unloadtime" property="unloadtime" jdbcType="BIGINT" />
		<result column="isClearing" property="isClearing" jdbcType="VARCHAR" />
		<result column="pathID" property="pathID" jdbcType="VARCHAR" />
		<result column="pickupweight" property="pickupweight" jdbcType="DOUBLE" />
		<result column="signweight" property="signweight" jdbcType="DOUBLE" />
		<result column="isAssess" property="isAssess" jdbcType="VARCHAR" />
		<result column="DESC1" property="desc1" jdbcType="VARCHAR" />
		<result column="DESC2" property="desc2" jdbcType="VARCHAR" />
		<result column="DESC3" property="desc3" jdbcType="VARCHAR" />
		<result column="DESC4" property="desc4" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		ID, planid, vehicleid, driverid, routeid, drivername,
		drivertel,isClearing,
		vehicleno, vehicletypeName,
		cargoname, startcity,
		consignorname, consignortel, endTime, startTime, endcity,
		receivername,
		receivertel, priceUnits, distance, price, type, status,
		waybillno, weight,
		trueweight,
		ownerid, venderid, venderdelflag,
		ownerdelflag, driverdelflag,
		orgid,plancode,creator, createtime,
		modifier, modifytime, pickupimgurl,
		signimgurl,overnumber,totalnumber,tallage,unloadtime,pathID,
		pickupweight, signweight, isAssess, DESC1, DESC2, DESC3, DESC4
	</sql>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		where ID = #{id,jdbcType=VARCHAR}
	</select>
	<select id="selectByCondition" resultMap="BaseResultMap"
		parameterType="com.tianrui.service.bean.Bill">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		<where>
			<if test="planid != null and planid!=''">
				and planid =#{planid,jdbcType=VARCHAR}
			</if>
			<if test="venderid != null and venderid!=''">
				and venderid=#{venderid,jdbcType=VARCHAR} and
				venderdelflag=0
			</if>
			<if test="vehicleid != null and vehicleid!=''">
				and vehicleid=#{vehicleid,jdbcType=VARCHAR}
			</if>
			<if test="status != null ">
				and status =#{status,jdbcType=TINYINT}
			</if>
			<if test="orgid != null and orgid != '' ">
				and orgid=#{orgid,jdbcType=VARCHAR}
			</if>
			<if test="ownerid != null and ownerid!=''">
				and ownerid=#{ownerid,jdbcType=VARCHAR} and
				ownerdelflag=0
			</if>
			<if test="plancode != null and plancode != ''">
				and plancode in (${plancode}) and ownerdelflag=0
			</if>
			<if test="queryKey != null and queryKey!=''">
				and (cargoname like '%${queryKey}%' or waybillno like '%${queryKey}%')
			</if>
			<if test="statusStrs != null">
				and status in
				<foreach collection="statusStrs" item="itemId" open="("
					separator="," close=")">
					#{itemId}
				</foreach>
			</if>
			<if test="overnumber != null and overnumber != ''">
				and overnumber=#{overnumber,jdbcType=VARCHAR}
			</if>
			<if test="totalnumber != null and totalnumber != ''">
				and totalnumber=#{totalnumber,jdbcType=VARCHAR}
			</if>
			<if test="tallage != null and tallage != ''">
				and tallage=#{tallage,jdbcType=DOUBLE}
			</if>
			<if test="unloadtime != null and unloadtime != ''">
				and unloadtime=#{unloadtime,jdbcType=BIGINT}
			</if>
			<if test="desc4 != null and desc4 != ''">
				and desc4=#{desc4,jdbcType=VARCHAR}
			</if>
			<if test="driverid != null and driverid!=''">
				and driverid=#{driverid,jdbcType=VARCHAR} and driverdelflag=0 and
				status != -1
				UNION
				select
				<include refid="Base_Column_List" />
				from wuliu_bill
				where id in (select billid from wuliu_transfer where
				startid=#{driverid,jdbcType=VARCHAR} and isvalid = "1" GROUP BY
				billid) and driverdelflag=0 and status != -1
				<if test="planid != null and planid!=''">
					and planid =#{planid,jdbcType=VARCHAR}
				</if>
				<if test="venderid != null and venderid!=''">
					and venderid=#{venderid,jdbcType=VARCHAR} and
					venderdelflag=0
				</if>
				<if test="vehicleid != null and vehicleid!=''">
					and vehicleid=#{vehicleid,jdbcType=VARCHAR}
				</if>
				<if test="status != null ">
					and status =#{status,jdbcType=TINYINT}
				</if>
				<if test="ownerid != null and ownerid!=''">
					and ownerid=#{ownerid,jdbcType=VARCHAR} and ownerdelflag
					=0
				</if>
				<if test="plancode != null and plancode != ''">
					and plancode in (${plancode}) and
					ownerdelflag=0
				</if>
				<if test="queryKey != null and queryKey!=''">
					and (cargoname like '%${queryKey}%' or waybillno like '%${queryKey}%')
				</if>
				<if test="statusStrs != null">
					and status in
					<foreach collection="statusStrs" item="itemId" open="("
						separator="," close=")">
						#{itemId}
					</foreach>
				</if>
				<if test="overnumber != null and overnumber != ''">
					and overnumber=#{overnumber,jdbcType=VARCHAR}
				</if>
				<if test="totalnumber != null and totalnumber != ''">
					and totalnumber=#{totalnumber,jdbcType=VARCHAR}
				</if>
				<if test="tallage != null and tallage != ''">
					and tallage=#{tallage,jdbcType=DOUBLE}
				</if>
				<if test="unloadtime != null and unloadtime != ''">
					and unloadtime=#{unloadtime,jdbcType=BIGINT}
				</if>
				<if test="desc4 != null and desc4 != ''">
					and desc4=#{desc4,jdbcType=VARCHAR}
				</if>
			</if>
		</where>
		order by modifytime desc
		<if test="start != null and start != '0'">
			<if test="limit !=null">
				limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
			</if>
		</if>

	</select>
	<select id="countByCondition" resultType="long"
		parameterType="com.tianrui.service.bean.Bill">
		select count(0)
		from (
		select
		id
		from wuliu_bill
		<where>
			<if test="planid != null and planid!=''">
				and planid =#{planid,jdbcType=VARCHAR}
			</if>
			<if test="venderid != null and venderid!=''">
				and venderid=#{venderid,jdbcType=VARCHAR} and
				venderdelflag=0
			</if>
			<if test="vehicleid != null and vehicleid!=''">
				and vehicleid=#{vehicleid,jdbcType=VARCHAR}
			</if>
			<if test="status != null ">
				and status =#{status,jdbcType=TINYINT}
			</if>
			<if test="orgid != null and orgid != '' ">
				and orgid=#{orgid,jdbcType=VARCHAR}
			</if>
			<if test="ownerid != null and ownerid!=''">
				and ownerid=#{ownerid,jdbcType=VARCHAR} and ownerdelflag
				=0
			</if>
			<if test="plancode != null and plancode != ''">
				and plancode in (${plancode}) and
				ownerdelflag=0
			</if>
			<if test="queryKey != null and queryKey!=''">
				and (cargoname like '%${queryKey}%' or waybillno like '%${queryKey}%')
			</if>
			<if test="statusStrs != null">
				and status in
				<foreach collection="statusStrs" item="itemId" open="("
					separator="," close=")">
					#{itemId}
				</foreach>
			</if>
			<if test="overnumber != null and overnumber != ''">
				and overnumber=#{overnumber,jdbcType=VARCHAR}
			</if>
			<if test="totalnumber != null and totalnumber != ''">
				and totalnumber=#{totalnumber,jdbcType=VARCHAR}
			</if>
			<if test="tallage != null and tallage != ''">
				and tallage=#{tallage,jdbcType=DOUBLE}
			</if>
			<if test="unloadtime != null and unloadtime != ''">
				and unloadtime=#{unloadtime,jdbcType=BIGINT}
			</if>
			<if test="desc4 != null and desc4 != ''">
				and desc4=#{desc4,jdbcType=VARCHAR}
			</if>
			<if test="driverid != null and driverid!=''">
				and driverid=#{driverid,jdbcType=VARCHAR} and driverdelflag=0 and
				status != -1
				UNION
				select id from wuliu_bill where id in (select
				billid from wuliu_transfer
				where startid=#{driverid,jdbcType=VARCHAR}
				and isvalid = "1" GROUP
				BY billid) and driverdelflag=0 and status !=
				-1
				<if test="planid != null and planid!=''">
					and planid =#{planid,jdbcType=VARCHAR}
				</if>
				<if test="venderid != null and venderid!=''">
					and venderid=#{venderid,jdbcType=VARCHAR} and
					venderdelflag=0
				</if>
				<if test="vehicleid != null and vehicleid!=''">
					and vehicleid=#{vehicleid,jdbcType=VARCHAR}
				</if>
				<if test="status != null ">
					and status =#{status,jdbcType=TINYINT}
				</if>
				<if test="ownerid != null and ownerid!=''">
					and ownerid=#{ownerid,jdbcType=VARCHAR} and ownerdelflag
					=0
				</if>
				<if test="plancode != null and plancode != ''">
					and plancode in (${plancode}) and
					ownerdelflag=0
				</if>
				<if test="queryKey != null and queryKey!=''">
					and (cargoname like '%${queryKey}%' or waybillno like '%${queryKey}%')
				</if>
				<if test="statusStrs != null">
					and status in
					<foreach collection="statusStrs" item="itemId" open="("
						separator="," close=")">
						#{itemId}
					</foreach>
				</if>
				<if test="overnumber != null and overnumber != ''">
					and overnumber=#{overnumber,jdbcType=VARCHAR}
				</if>
				<if test="totalnumber != null and totalnumber != ''">
					and totalnumber=#{totalnumber,jdbcType=VARCHAR}
				</if>
				<if test="tallage != null and tallage != ''">
					and tallage=#{tallage,jdbcType=DOUBLE}
				</if>
				<if test="unloadtime != null and unloadtime != ''">
					and unloadtime=#{unloadtime,jdbcType=BIGINT}
				</if>
				<if test="desc4 != null and desc4 != ''">
					and desc4=#{desc4,jdbcType=VARCHAR}
				</if>
			</if>
		</where>
		) b
	</select>
	<select id="querySumWithPlan" resultType="Double"
		parameterType="com.tianrui.service.bean.Bill">
		select
		sum(weight) weight
		from wuliu_bill
		<where>
			<if test="planid != null and planid!=''">
				and planid =#{planid,jdbcType=VARCHAR}
			</if>
			<if test="statusStrs != null">
				and status in
				<foreach collection="statusStrs" item="itemId" open="("
					separator="," close=")">
					#{itemId}
				</foreach>
			</if>
		</where>
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		delete from
		wuliu_bill
		where ID = #{id,jdbcType=VARCHAR}
	</delete>
	<insert id="insert" parameterType="com.tianrui.service.bean.Bill">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into wuliu_bill (ID, planid, vehicleid,
		driverid, routeid,
		drivername,
		drivertel, vehicleno, vehicletypeName,
		cargoname, startcity,
		consignorname,
		consignortel, endTime, startTime,
		endcity, receivername,
		receivertel,
		priceUnits, distance, price,
		type, status, waybillno,
		weight, trueweight, ownerid,
		venderid, venderdelflag, ownerdelflag,
		driverdelflag, orgid,plancode,creator, createtime,
		modifier,
		modifytime, overnumber,totalnumber, tallage,unloadtime, DESC1,
		DESC2,
		DESC3, DESC4,isClearing,pathID,pickupweight, signweight,isAssess
		)
		values
		(#{id,jdbcType=VARCHAR},
		#{planid,jdbcType=VARCHAR},
		#{vehicleid,jdbcType=VARCHAR},
		#{driverid,jdbcType=VARCHAR},
		#{routeid,jdbcType=VARCHAR},
		#{drivername,jdbcType=VARCHAR},
		#{drivertel,jdbcType=VARCHAR},
		#{vehicleno,jdbcType=VARCHAR},
		#{vehicletypename,jdbcType=VARCHAR},
		#{cargoname,jdbcType=VARCHAR},
		#{startcity,jdbcType=VARCHAR},
		#{consignorname,jdbcType=VARCHAR},
		#{consignortel,jdbcType=VARCHAR},
		#{endtime,jdbcType=VARCHAR},
		#{starttime,jdbcType=VARCHAR},
		#{endcity,jdbcType=VARCHAR},
		#{receivername,jdbcType=VARCHAR},
		#{receivertel,jdbcType=VARCHAR},
		#{priceunits,jdbcType=VARCHAR},
		#{distance,jdbcType=DOUBLE},
		#{price,jdbcType=DOUBLE},
		#{type,jdbcType=TINYINT},
		#{status,jdbcType=TINYINT},
		#{waybillno,jdbcType=VARCHAR},
		#{weight,jdbcType=DOUBLE},
		#{trueweight,jdbcType=DOUBLE},
		#{ownerid,jdbcType=VARCHAR},
		#{venderid,jdbcType=VARCHAR},
		#{venderdelflag,jdbcType=TINYINT},
		#{ownerdelflag,jdbcType=TINYINT},
		#{driverdelflag,jdbcType=TINYINT},
		#{orgid,jdbcType=VARCHAR},#{plancode,jdbcType=VARCHAR},#{creator,jdbcType=VARCHAR},
		#{createtime,jdbcType=BIGINT},
		#{modifier,jdbcType=VARCHAR},
		#{modifytime,jdbcType=BIGINT}, #{overnumber,jdbcType=VARCHAR},
		#{totalnumber,jdbcType=VARCHAR},
		#{tallage,jdbcType=DOUBLE},#{unloadtime,jdbcType=BIGINT},
		#{desc1,jdbcType=VARCHAR}, #{desc2,jdbcType=VARCHAR},
		#{desc3,jdbcType=VARCHAR}, #{desc4,jdbcType=VARCHAR},
		#{isClearing,jdbcType=VARCHAR}, #{pathID,jdbcType=VARCHAR}, 
		#{pickupweight,jdbcType=DOUBLE}, #{signweight,jdbcType=DOUBLE},
		#{isAssess,jdbcType=VARCHAR}
		)
	</insert>
	<insert id="insertSelective" parameterType="com.tianrui.service.bean.Bill">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into wuliu_bill
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				ID,
			</if>
			<if test="planid != null">
				planid,
			</if>
			<if test="vehicleid != null">
				vehicleid,
			</if>
			<if test="driverid != null">
				driverid,
			</if>
			<if test="routeid != null">
				routeid,
			</if>
			<if test="drivername != null">
				drivername,
			</if>
			<if test="drivertel != null">
				drivertel,
			</if>
			<if test="vehicleno != null">
				vehicleno,
			</if>
			<if test="vehicletypename != null">
				vehicletypeName,
			</if>
			<if test="cargoname != null">
				cargoname,
			</if>
			<if test="startcity != null">
				startcity,
			</if>
			<if test="consignorname != null">
				consignorname,
			</if>
			<if test="consignortel != null">
				consignortel,
			</if>
			<if test="endtime != null">
				endTime,
			</if>
			<if test="starttime != null">
				startTime,
			</if>
			<if test="endcity != null">
				endcity,
			</if>
			<if test="receivername != null">
				receivername,
			</if>
			<if test="receivertel != null">
				receivertel,
			</if>
			<if test="priceunits != null">
				priceUnits,
			</if>
			<if test="distance != null">
				distance,
			</if>
			<if test="price != null">
				price,
			</if>
			<if test="type != null">
				type,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="waybillno != null">
				waybillno,
			</if>
			<if test="weight != null">
				weight,
			</if>
			<if test="trueweight != null">
				trueweight,
			</if>
			<if test="ownerid != null">
				ownerid,
			</if>
			<if test="venderid != null">
				venderid,
			</if>
			<if test="venderdelflag != null">
				venderdelflag,
			</if>
			<if test="ownerdelflag != null">
				ownerdelflag,
			</if>
			<if test="driverdelflag != null">
				driverdelflag,
			</if>
			<if test="orgid != null">
				orgid,
			</if>
			<if test="plancode != null">
				plancode,
			</if>
			<if test="creator != null">
				creator,
			</if>
			<if test="createtime != null">
				createtime,
			</if>
			<if test="modifier != null">
				modifier,
			</if>
			<if test="modifytime != null">
				modifytime,
			</if>
			<if test="overnumber != null">
				overnumber,
			</if>
			<if test="totalnumber != null">
				totalnumber,
			</if>
			<if test="tallage != null">
				tallage,
			</if>
			<if test="unloadtime != null">
				unloadtime,
			</if>
			<if test="desc1 != null">
				DESC1,
			</if>
			<if test="desc2 != null">
				DESC2,
			</if>
			<if test="desc3 != null">
				DESC3,
			</if>
			<if test="desc4 != null">
				DESC4,
			</if>
			<if test="isClearing != null">
				isClearing,
			</if>
			<if test="pathID != null">
				pathID,
			</if>
			<if test="pickupweight != null">
				pickupweight,
			</if>
			<if test="signweight != null">
				signweight,
			</if>
			<if test="isAssess != null">
				isAssess,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=VARCHAR},
			</if>
			<if test="planid != null">
				#{planid,jdbcType=VARCHAR},
			</if>
			<if test="vehicleid != null">
				#{vehicleid,jdbcType=VARCHAR},
			</if>
			<if test="driverid != null">
				#{driverid,jdbcType=VARCHAR},
			</if>
			<if test="routeid != null">
				#{routeid,jdbcType=VARCHAR},
			</if>
			<if test="drivername != null">
				#{drivername,jdbcType=VARCHAR},
			</if>
			<if test="drivertel != null">
				#{drivertel,jdbcType=VARCHAR},
			</if>
			<if test="vehicleno != null">
				#{vehicleno,jdbcType=VARCHAR},
			</if>
			<if test="vehicletypename != null">
				#{vehicletypename,jdbcType=VARCHAR},
			</if>
			<if test="cargoname != null">
				#{cargoname,jdbcType=VARCHAR},
			</if>
			<if test="startcity != null">
				#{startcity,jdbcType=VARCHAR},
			</if>
			<if test="consignorname != null">
				#{consignorname,jdbcType=VARCHAR},
			</if>
			<if test="consignortel != null">
				#{consignortel,jdbcType=VARCHAR},
			</if>
			<if test="endtime != null">
				#{endtime,jdbcType=VARCHAR},
			</if>
			<if test="starttime != null">
				#{starttime,jdbcType=VARCHAR},
			</if>
			<if test="endcity != null">
				#{endcity,jdbcType=VARCHAR},
			</if>
			<if test="receivername != null">
				#{receivername,jdbcType=VARCHAR},
			</if>
			<if test="receivertel != null">
				#{receivertel,jdbcType=VARCHAR},
			</if>
			<if test="priceunits != null">
				#{priceunits,jdbcType=VARCHAR},
			</if>
			<if test="distance != null">
				#{distance,jdbcType=DOUBLE},
			</if>
			<if test="price != null">
				#{price,jdbcType=DOUBLE},
			</if>
			<if test="type != null">
				#{type,jdbcType=TINYINT},
			</if>
			<if test="status != null">
				#{status,jdbcType=TINYINT},
			</if>
			<if test="waybillno != null">
				#{waybillno,jdbcType=VARCHAR},
			</if>
			<if test="weight != null">
				#{weight,jdbcType=DOUBLE},
			</if>
			<if test="trueweight != null">
				#{trueweight,jdbcType=DOUBLE},
			</if>
			<if test="ownerid != null">
				#{ownerid,jdbcType=VARCHAR},
			</if>
			<if test="venderid != null">
				#{venderid,jdbcType=VARCHAR},
			</if>
			<if test="venderdelflag != null">
				#{venderdelflag,jdbcType=TINYINT},
			</if>
			<if test="ownerdelflag != null">
				#{ownerdelflag,jdbcType=TINYINT},
			</if>
			<if test="driverdelflag != null">
				#{driverdelflag,jdbcType=TINYINT},
			</if>
			<if test="orgid != null">
				#{orgid,jdbcType=VARCHAR},
			</if>
			<if test="plancode != null">
				#{plancode,jdbcType=VARCHAR},
			</if>
			<if test="creator != null">
				#{creator,jdbcType=VARCHAR},
			</if>
			<if test="createtime != null">
				#{createtime,jdbcType=BIGINT},
			</if>
			<if test="modifier != null">
				#{modifier,jdbcType=VARCHAR},
			</if>
			<if test="modifytime != null">
				#{modifytime,jdbcType=BIGINT},
			</if>
			<if test="overnumber != null">
				#{overnumber,jdbcType=VARCHAR},
			</if>
			<if test="totalnumber != null">
				#{totalnumber,jdbcType=VARCHAR},
			</if>
			<if test="tallage != null">
				#{tallage,jdbcType=DOUBLE},
			</if>
			<if test="unloadtime != null">
				#{unloadtime,jdbcType=BIGINT},
			</if>
			<if test="desc1 != null">
				#{desc1,jdbcType=VARCHAR},
			</if>
			<if test="desc2 != null">
				#{desc2,jdbcType=VARCHAR},
			</if>
			<if test="desc3 != null">
				#{desc3,jdbcType=VARCHAR},
			</if>
			<if test="desc4 != null">
				#{desc4,jdbcType=VARCHAR},
			</if>
			<if test="isClearing != null">
				#{isClearing,jdbcType=VARCHAR},
			</if>
			<if test="pathID != null">
				#{pathID,jdbcType=VARCHAR},
			</if>
			<if test="pickupweight != null">
				#{pickupweight,jdbcType=DOUBLE},
			</if>
			<if test="signweight != null">
				#{signweight,jdbcType=DOUBLE},
			</if>
			<if test="isAssess != null">
				#{isAssess,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.tianrui.service.bean.Bill">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update wuliu_bill
		<set>
			<if test="planid != null">
				planid = #{planid,jdbcType=VARCHAR},
			</if>
			<if test="vehicleid != null">
				vehicleid = #{vehicleid,jdbcType=VARCHAR},
			</if>
			<if test="driverid != null">
				driverid = #{driverid,jdbcType=VARCHAR},
			</if>
			<if test="routeid != null">
				routeid = #{routeid,jdbcType=VARCHAR},
			</if>
			<if test="drivername != null">
				drivername = #{drivername,jdbcType=VARCHAR},
			</if>
			<if test="drivertel != null">
				drivertel = #{drivertel,jdbcType=VARCHAR},
			</if>
			<if test="vehicleno != null">
				vehicleno = #{vehicleno,jdbcType=VARCHAR},
			</if>
			<if test="vehicletypename != null">
				vehicletypeName = #{vehicletypename,jdbcType=VARCHAR},
			</if>
			<if test="cargoname != null">
				cargoname = #{cargoname,jdbcType=VARCHAR},
			</if>
			<if test="startcity != null">
				startcity = #{startcity,jdbcType=VARCHAR},
			</if>
			<if test="consignorname != null">
				consignorname = #{consignorname,jdbcType=VARCHAR},
			</if>
			<if test="consignortel != null">
				consignortel = #{consignortel,jdbcType=VARCHAR},
			</if>
			<if test="endtime != null">
				endTime = #{endtime,jdbcType=VARCHAR},
			</if>
			<if test="starttime != null">
				startTime = #{starttime,jdbcType=VARCHAR},
			</if>
			<if test="endcity != null">
				endcity = #{endcity,jdbcType=VARCHAR},
			</if>
			<if test="receivername != null">
				receivername = #{receivername,jdbcType=VARCHAR},
			</if>
			<if test="receivertel != null">
				receivertel = #{receivertel,jdbcType=VARCHAR},
			</if>
			<if test="priceunits != null">
				priceUnits = #{priceunits,jdbcType=VARCHAR},
			</if>
			<if test="distance != null">
				distance = #{distance,jdbcType=DOUBLE},
			</if>
			<if test="price != null">
				price = #{price,jdbcType=DOUBLE},
			</if>
			<if test="type != null">
				type = #{type,jdbcType=TINYINT},
			</if>
			<if test="status != null">
				status = #{status,jdbcType=TINYINT},
			</if>
			<if test="waybillno != null">
				waybillno = #{waybillno,jdbcType=VARCHAR},
			</if>
			<if test="weight != null">
				weight = #{weight,jdbcType=DOUBLE},
			</if>
			<if test="trueweight != null">
				trueweight = #{trueweight,jdbcType=DOUBLE},
			</if>
			<if test="ownerid != null">
				ownerid = #{ownerid,jdbcType=VARCHAR},
			</if>
			<if test="venderid != null">
				venderid = #{venderid,jdbcType=VARCHAR},
			</if>
			<if test="venderdelflag != null">
				venderdelflag = #{venderdelflag,jdbcType=TINYINT},
			</if>
			<if test="ownerdelflag != null">
				ownerdelflag = #{ownerdelflag,jdbcType=TINYINT},
			</if>
			<if test="driverdelflag != null">
				driverdelflag = #{driverdelflag,jdbcType=TINYINT},
			</if>
			<if test="orgid != null">
				orgid = #{orgid,jdbcType=VARCHAR},
			</if>
			<if test="plancode != null">
				plancode = #{plancode,jdbcType=VARCHAR},
			</if>
			<if test="creator != null">
				creator = #{creator,jdbcType=VARCHAR},
			</if>
			<if test="createtime != null">
				createtime = #{createtime,jdbcType=BIGINT},
			</if>
			<if test="modifier != null">
				modifier = #{modifier,jdbcType=VARCHAR},
			</if>
			<if test="pickupimgurl != null">
				pickupimgurl = #{pickupimgurl,jdbcType=VARCHAR},
			</if>
			<if test="signimgurl != null">
				signimgurl = #{signimgurl,jdbcType=VARCHAR},
			</if>
			<if test="modifytime != null">
				modifytime = #{modifytime,jdbcType=BIGINT},
			</if>
			<if test="overnumber != null">
				overnumber = #{overnumber,jdbcType=VARCHAR},
			</if>
			<if test="totalnumber != null">
				totalnumber = #{totalnumber,jdbcType=VARCHAR},
			</if>
			<if test="tallage != null">
				tallage = #{tallage,jdbcType=DOUBLE},
			</if>
			<if test="unloadtime != null">
				unloadtime = #{unloadtime,jdbcType=BIGINT},
			</if>
			<if test="desc1 != null">
				DESC1 = #{desc1,jdbcType=VARCHAR},
			</if>
			<if test="desc2 != null">
				DESC2 = #{desc2,jdbcType=VARCHAR},
			</if>
			<if test="desc3 != null">
				DESC3 = #{desc3,jdbcType=VARCHAR},
			</if>
			<if test="desc4 != null">
				DESC4 = #{desc4,jdbcType=VARCHAR},
			</if>
			<if test="isClearing != null">
				isClearing = #{isClearing,jdbcType=VARCHAR},
			</if>
			<if test="pathID != null">
				pathID = #{pathID,jdbcType=VARCHAR},
			</if>
			<if test="pickupweight != null">
				pickupweight = #{pickupweight,jdbcType=DOUBLE},
			</if>
			<if test="signweight != null">
				signweight = #{signweight,jdbcType=DOUBLE},
			</if>
			<if test="isAssess != null">
				isAssess = #{isAssess,jdbcType=VARCHAR},
			</if>
		</set>
		where ID = #{id,jdbcType=VARCHAR}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.tianrui.service.bean.Bill">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update wuliu_bill
		set planid = #{planid,jdbcType=VARCHAR},
		vehicleid =
		#{vehicleid,jdbcType=VARCHAR},
		driverid = #{driverid,jdbcType=VARCHAR},
		routeid = #{routeid,jdbcType=VARCHAR},
		drivername =
		#{drivername,jdbcType=VARCHAR},
		drivertel =
		#{drivertel,jdbcType=VARCHAR},
		vehicleno =
		#{vehicleno,jdbcType=VARCHAR},
		vehicletypeName =
		#{vehicletypename,jdbcType=VARCHAR},
		cargoname =
		#{cargoname,jdbcType=VARCHAR},
		startcity =
		#{startcity,jdbcType=VARCHAR},
		consignorname =
		#{consignorname,jdbcType=VARCHAR},
		consignortel =
		#{consignortel,jdbcType=VARCHAR},
		endTime =
		#{endtime,jdbcType=VARCHAR},
		startTime = #{starttime,jdbcType=VARCHAR},
		endcity = #{endcity,jdbcType=VARCHAR},
		receivername =
		#{receivername,jdbcType=VARCHAR},
		receivertel =
		#{receivertel,jdbcType=VARCHAR},
		priceUnits =
		#{priceunits,jdbcType=VARCHAR},
		distance = #{distance,jdbcType=DOUBLE},
		price = #{price,jdbcType=DOUBLE},
		type = #{type,jdbcType=TINYINT},
		status = #{status,jdbcType=TINYINT},
		waybillno =
		#{waybillno,jdbcType=VARCHAR},
		weight = #{weight,jdbcType=DOUBLE},
		trueweight = #{trueweight,jdbcType=DOUBLE},
		ownerid =
		#{ownerid,jdbcType=VARCHAR},
		venderid = #{venderid,jdbcType=VARCHAR},
		venderdelflag = #{venderdelflag,jdbcType=TINYINT},
		ownerdelflag =
		#{ownerdelflag,jdbcType=TINYINT},
		driverdelflag =
		#{driverdelflag,jdbcType=TINYINT},
		orgid = #{orgid,jdbcType=VARCHAR},
		plancode = #{plancode,jdbcType=VARCHAR},
		creator =
		#{creator,jdbcType=VARCHAR},
		createtime =
		#{createtime,jdbcType=BIGINT},
		modifier = #{modifier,jdbcType=VARCHAR},
		modifytime = #{modifytime,jdbcType=BIGINT},
		DESC1 =
		#{desc1,jdbcType=VARCHAR},
		DESC2 = #{desc2,jdbcType=VARCHAR},
		DESC3 =
		#{desc3,jdbcType=VARCHAR},
		DESC4 = #{desc4,jdbcType=VARCHAR},
		isClearing = #{isClearing,jdbcType=VARCHAR},
		pathID = #{pathID,jdbcType=VARCHAR},
		pickupweight = #{pickupweight,jdbcType=DOUBLE},
		signweight = #{signweight,jdbcType=DOUBLE},
		isAssess = #{isAssess,jdbcType=VARCHAR}
		where ID = #{id,jdbcType=VARCHAR}
	</update>
	<update id="updateByBillTransfer" parameterType="com.tianrui.service.bean.BillUpdate">
		update
		wuliu_bill
		set
		driverid = #{driverid,jdbcType=VARCHAR},
		drivername =
		#{drivername,jdbcType=VARCHAR},
		drivertel =
		#{drivertel,jdbcType=VARCHAR}
		WHERE
		driverid =
		#{startdriverid,jdbcType=VARCHAR}
		AND venderid =
		#{venderid,jdbcType=VARCHAR}
		AND status IN (0,1,2,3,4,5)
	</update>
	<select id="selectByBillTransfer" resultMap="BaseResultMap"
		parameterType="com.tianrui.service.bean.Bill">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		where
		driverid = #{driverid,jdbcType=VARCHAR}
		AND
		venderid = #{venderid,jdbcType=VARCHAR}
		AND status IN (0,1,2,3,4)
		AND
		ownerdelflag = 0 and venderdelflag = 0 and driverdelflag = 0
	</select>
	<select id="selectByPlanId" resultMap="BaseResultMap"
		parameterType="string">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		where planid = #{planid,jdbcType=VARCHAR} and
		ownerdelflag = 0 and
		venderdelflag = 0 and driverdelflag = 0 and
		status
		not in (-1,7)
	</select>
	<select id="selectBillByCapaId" parameterType="map"
		resultType="com.tianrui.service.bean.Bill">
		select b.*
		from wuliu_bill b RIGHT JOIN wuliu_member_capa c
		ON b.vehicleid = c.vehicleid
		where c.`status` = 1 and b.`status` != 6
		and b.venderid =
		#{venderid,jdbcType=VARCHAR} and c.id =
		#{capaId,jdbcType=VARCHAR}
	</select>
	<select id="selectAppointPageByPlanIds" parameterType="map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		where venderdelflag = '0'
		<if test="queryKey != null and queryKey!=''">
			and (cargoname like
			concat(#{queryKey,jdbcType=VARCHAR},'%') or
			waybillno like
			concat(#{queryKey,jdbcType=VARCHAR} ,'%'))
		</if>
		and planid in
		<foreach collection="list" index="index" item="item" open="("
			separator="," close=")">
			#{item}
		</foreach>
		order by modifytime desc
		<if test="start != null and start != '0'">
			<if test="limit !=null">
				limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
			</if>
		</if>
	</select>
	<select id="selectAppointCountByPlanIds" parameterType="map"
		resultType="integer">
		select count(0)
		from wuliu_bill
		where venderdelflag = '0'
		<if test="queryKey != null and queryKey!=''">
			and (cargoname like
			concat(#{queryKey,jdbcType=VARCHAR},'%') or
			waybillno like
			concat(#{queryKey,jdbcType=VARCHAR} ,'%'))
		</if>
		and planid in
		<foreach collection="list" index="index" item="item" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</select>

	<select id="selectByConditionForBack" resultMap="BaseResultMap"
		parameterType="com.tianrui.service.bean.Bill">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		<where>
			<if test="status != null ">
				and status =#{status,jdbcType=TINYINT}
			</if>
			<if test="orgid != null and orgid != '' ">
				and orgid=#{orgid,jdbcType=VARCHAR} and type != 2
			</if>

		</where>
		order by modifytime desc
		<if test="start != null and start != '0'">
			<if test="limit !=null">
				limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
			</if>
		</if>

	</select>
	<select id="countByConditionForBack" resultType="long"
		parameterType="com.tianrui.service.bean.Bill">
		select
		count(0)
		from wuliu_bill
		<where>
			<if test="status != null ">
				and status =#{status,jdbcType=TINYINT}
			</if>
			<if test="orgid != null and orgid != '' ">
				and orgid=#{orgid,jdbcType=VARCHAR} and type != 2
			</if>
		</where>
	</select>
	<select id="queryAppointPage" parameterType="com.tianrui.service.bean.Bill"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from wuliu_bill
		where INSTR(pathID,'${pathID}')
		<if test="queryKey != null and queryKey!=''">
			and (cargoname like
			concat(#{queryKey,jdbcType=VARCHAR},'%') or
			waybillno like
			concat(#{queryKey,jdbcType=VARCHAR} ,'%'))
		</if>
		and ownerdelflag=0 and venderdelflag=0 and driverdelflag=0
		order by
		modifytime desc
		<if test="start != null and start != '0'">
			<if test="limit !=null">
				limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
			</if>
		</if>
	</select>
	<select id="queryAppointCount" parameterType="com.tianrui.service.bean.Bill"
		resultType="int">
		select count(0)
		from wuliu_bill
		where INSTR(pathID,'${pathID}')
		<if test="queryKey != null and queryKey!=''">
			and (cargoname like
			concat(#{queryKey,jdbcType=VARCHAR},'%') or
			waybillno like
			concat(#{queryKey,jdbcType=VARCHAR} ,'%'))
		</if>
		and ownerdelflag=0 and venderdelflag=0 and driverdelflag=0
	</select>
	<select id="queryReportBill" parameterType="com.tianrui.common.vo.ReportVo"
		resultMap="BaseResultMap">
		select A.*
		from wuliu_bill A left join wuliu_member_owner B
		on
		A.venderid=B.ownerid
		where A.venderdelflag=0 and A.ownerdelflag=0 and
		A.driverdelflag=0 and
		A.type=0 and A.status=6
		<if test="starttime != null and starttime != ''">
			and A.unloadtime <![CDATA[>=]]>
			#{starttime,jdbcType=BIGINT}
		</if>
		<if test="endtime != null and endtime != ''">
			and A.unloadtime <![CDATA[<]]>
			#{endtime,jdbcType=BIGINT}
		</if>
		<if test="memberid != null and memberid != ''">
			and A.ownerid = #{memberid,jdbcType=VARCHAR}
		</if>
		<if test="vendername != null and vendername != ''">
			and B.ownername like '%${vendername}%'
		</if>
		<if test="cargoname != null and cargoname != ''">
			and A.cargoname like '%${cargoname}%'
		</if>
		<if test="startcity != null and startcity != ''">
			and A.startcity like '%${startcity}%'
		</if>
		<if test="endcity != null and endcity != ''">
			and A.endcity like '%${endcity}%'
		</if>
		<if test="order != null and order != ''">
			order by ${order}
		</if>
	</select>
	<select id="queryComplete" resultType="double" parameterType="map">
		select IFNULL(sum(trueweight),0)
		from wuliu_bill
		where plancode=#{plancode,jdbcType=VARCHAR}
			and (venderid=#{venderid,jdbcType=VARCHAR} or INSTR(pathID,#{venderid,jdbcType=VARCHAR}))
			and ownerdelflag = 0
			and venderdelflag = 0
			and driverdelflag = 0
	</select>
	<select id="queryAdminStatReport" parameterType="com.tianrui.api.req.front.adminReport.StatReportReq" resultType="com.tianrui.api.resp.front.adminReport.StatReportOfBillResp">
		SELECT
			b.*, r.routename routeName, b.cargoname cargoName,
			IFNULL(i.username, i.companyname) ownerName, 
			IFNULL(i1.username, i1.companyname) venderName	, 
			o.organizationname orgName, b.drivername driverName, 
			b.waybillno billCode, b.DESC1 measunit, b.DESC4 isAppoint
		FROM 
			wuliu_bill b
	  	LEFT JOIN	wuliu_plan p ON b.planid = p.ID
		LEFT JOIN file_freight f ON p.freightid = f.ID
		LEFT JOIN file_route r ON f.routeid = r.ID
		LEFT JOIN member_info i ON b.ownerid = i.memberid
		LEFT JOIN member_info i1 ON b.venderid = i1.memberid
		LEFT JOIN file_org o ON b.orgid = o.ID
		LEFT JOIN member m ON b.ownerid = m.id
		WHERE 
			b.ownerDelFlag=0 AND b.venderDelFlag=0 AND b.driverdelflag=0 AND b.type != 2
			<if test="cargoname != null and cargoname != ''">
				AND b.cargoname like '%${cargoname}%'
			</if>
			<if test="routename != null and routename != ''">
				AND r.routename like '%${routename}%'
			</if>
			<if test="orgid != null and orgid != ''">
				AND m.orgid = #{orgid,jdbcType=VARCHAR}
			</if>
			<if test="plancode != null and plancode != ''">
				AND b.planCode = #{plancode,jdbcType=VARCHAR}
			</if>
			<if test="starttime != null and starttime != ''">
				AND b.createtime >= #{starttime,jdbcType=BIGINT}
			</if>
			<if test="endtime != null and endtime != ''">
				AND b.createtime <![CDATA[<=]]> #{endtime,jdbcType=BIGINT}
			</if>
		ORDER BY b.createtime 
		<if test="start != null and start >= 0">
	   		<if test="limit !=null and limit >0" >
	     		limit #{start,jdbcType=INTEGER},#{limit,jdbcType=INTEGER}
	    	</if>
		</if>
	</select>
	<select id="queryAdminStatReportCount" parameterType="com.tianrui.api.req.front.adminReport.StatReportReq" resultType="int">
		SELECT
			count(1)
		FROM 
			wuliu_bill b
	  	LEFT JOIN	wuliu_plan p ON b.planid = p.ID
		LEFT JOIN file_freight f ON p.freightid = f.ID
		LEFT JOIN file_route r ON f.routeid = r.ID
		LEFT JOIN member_info i ON b.ownerid = i.memberid
		LEFT JOIN member_info i1 ON b.venderid = i1.memberid
		LEFT JOIN file_org o ON b.orgid = o.ID
		LEFT JOIN member m ON b.ownerid = m.id
		WHERE 
			b.ownerDelFlag=0 AND b.venderDelFlag=0 AND b.driverdelflag=0 AND b.type != 2
			<if test="cargoname != null and cargoname != ''">
				AND b.cargoname like '%${cargoname}%'
			</if>
			<if test="routename != null and routename != ''">
				AND r.routename like '%${routename}%'
			</if>
			<if test="orgid != null and orgid != ''">
				AND m.orgid = #{orgid,jdbcType=VARCHAR}
			</if>
			<if test="plancode != null and plancode != ''">
				AND b.planCode = #{plancode,jdbcType=VARCHAR}
			</if>
			<if test="starttime != null and starttime != ''">
				AND b.createtime >= #{starttime,jdbcType=BIGINT}
			</if>
			<if test="endtime != null and endtime != ''">
				AND b.createtime <![CDATA[<=]]> #{endtime,jdbcType=BIGINT}
			</if>
	</select>
	<select id="queryAdminAllStatReport" parameterType="com.tianrui.api.req.front.adminReport.StatReportReq" resultType="com.tianrui.api.resp.front.adminReport.StatReportOfBillResp">
		SELECT
			b.*, r.routename routeName, b.cargoname cargoName,
			IFNULL(i.username, i.companyname) ownerName, 
			IFNULL(i1.username, i1.companyname) venderName	, 
			o.organizationname orgName, b.drivername driverName, 
			b.waybillno billCode, b.DESC1 measunit, b.DESC4 isAppoint
		FROM 
			wuliu_bill b
	  	LEFT JOIN	wuliu_plan p ON b.planid = p.ID
		LEFT JOIN file_freight f ON p.freightid = f.ID
		LEFT JOIN file_route r ON f.routeid = r.ID
		LEFT JOIN member_info i ON b.ownerid = i.memberid
		LEFT JOIN member_info i1 ON b.venderid = i1.memberid
		LEFT JOIN file_org o ON b.orgid = o.ID
		LEFT JOIN member m ON b.ownerid = m.id
		WHERE 
			b.ownerDelFlag=0 AND b.venderDelFlag=0 AND b.driverdelflag=0 AND b.type != 2
			<if test="cargoname != null and cargoname != ''">
				AND b.cargoname like '%${cargoname}%'
			</if>
			<if test="routename != null and routename != ''">
				AND r.routename like '%${routename}%'
			</if>
			<if test="orgid != null and orgid != ''">
				AND m.orgid = #{orgid,jdbcType=VARCHAR}
			</if>
			<if test="plancode != null and plancode != ''">
				AND b.planCode = #{plancode,jdbcType=VARCHAR}
			</if>
			<if test="starttime != null and starttime != ''">
				AND b.createtime >= #{starttime,jdbcType=BIGINT}
			</if>
			<if test="endtime != null and endtime != ''">
				AND b.createtime <![CDATA[<=]]> #{endtime,jdbcType=BIGINT}
			</if>
		ORDER BY b.createtime 
	</select>
	<select id="queryCountByVenderId" parameterType="java.util.Map" resultType="int">
		select count(0)
		from wuliu_bill 
		where venderid = #{venderid,jdbcType=VARCHAR} and venderdelflag = 0
			and createtime <![CDATA[>=]]> #{starttime,jdbcType=BIGINT} 
  			and createtime <![CDATA[<]]> #{endtime,jdbcType=BIGINT}
	</select>
</mapper>